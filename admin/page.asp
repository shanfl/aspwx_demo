<%
Sub PageControl(iCount,pagecount,page,table_style,font_style) 
'生成上一页下一页链接 
Dim query, a, x, temp 
action = "http://" & Request.ServerVariables("HTTP_HOST") & Request.ServerVariables("SCRIPT_NAME") 

query = Split(Request.ServerVariables("QUERY_STRING"), "&") 
For Each x In query 
a = Split(x, "=") 
If StrComp(a(0), "page", vbTextCompare) <> 0 Then 
temp = temp & a(0) & "=" & a(1) & "&" 
End If 
Next 

Response.Write("<div " & Table_style & ">" & vbCrLf ) 
Response.Write("<form method=get onsubmit=""document.location = '" & action & "?" & temp & "Page='+ this.page.value;return false;"">" & vbCrLf ) 
Response.Write("" & vbCrLf ) 
Response.Write(font_style & vbCrLf ) 

if page<=1 then 
Response.Write ("首页 " & vbCrLf) 
Response.Write ("上页 " & vbCrLf) 
else 
Response.Write("<a href=" & action & "?" & temp & "Page=1>首页</a> " & vbCrLf) 
Response.Write("<a href=" & action & "?" & temp & "Page=" & (Page-1) & ">上页</a> " & vbCrLf) 
end if 

if page>=pagecount then 
Response.Write ("下页 " & vbCrLf) 
Response.Write ("尾页 " & vbCrLf) 
else 
Response.Write("<a href=" & action & "?" & temp & "Page=" & (Page+1) & ">下页</a> " & vbCrLf) 
Response.Write("<a href=" & action & "?" & temp & "Page=" & pagecount & ">尾页</a> " & vbCrLf) 
end if 

Response.Write(" 页次：" & page & "/" & pageCount & "页" & vbCrLf) 
Response.Write(" 共有" & iCount & "条记录" & vbCrLf) 
Response.Write(" 转到" & "<input type='text' name=page size=1 Maxlength=5 value=" & page & " class='InputText' />" & "页" & vbCrLf & "<input type='submit' value='GO' class='InputButton' />") 
Response.Write("" & vbCrLf ) 
Response.Write("</form>" & vbCrLf ) 
Response.Write("</div>" & vbCrLf ) 
End Sub
%>
